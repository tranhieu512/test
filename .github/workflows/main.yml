name: Auto Update MIN (Python) üîÑ

# C·∫•u h√¨nh c√°c Trigger (S·ª± ki·ªán k√≠ch ho·∫°t)
on:
  # Ch·∫°y m·ªói 5 ph√∫t (Nh∆∞ code c≈© c·ªßa b·∫°n)
  schedule:
    - cron: '*/5 * * * *' 
  workflow_dispatch: {}

env:
  TZ: Asia/Ho_Chi_Minh

jobs:
  Update:
    runs-on: ubuntu-latest
    steps:
      - name: ‚¨áÔ∏è Checkout Code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 
          
      - name: üêç Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.12'

      - name: üì¶ Install dependencies
        # C·∫ßn c√†i ƒë·∫∑t th∆∞ vi·ªán 'requests' ƒë·ªÉ script t·∫£i c√°c ngu·ªìn M3U
        run: pip install requests
        
      - name: ‚öôÔ∏è Run Python script (Process M3U)
        # Ch·∫°y script Python ƒë·ªÉ t·∫£i, l·ªçc v√† t·∫°o file MIN.m3u
        run: python scripts/process_m3u.py
        
      - name: ‚è±Ô∏è GetTime for Commit Message
        run: echo "DATE=$(date +'%Y-%m-%d %H:%M:%S GMT+7')" >> $GITHUB_ENV
        
      # B∆∞·ªõc n√†y thay th·∫ø ho√†n to√†n cho b∆∞·ªõc 'Clean' v√† 'Push' ph·ª©c t·∫°p c≈©
      - name: ‚¨ÜÔ∏è Commit and Push Updated M3U
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          file_pattern: MIN.m3u
          commit_message: "Auto Update in ${{ env.DATE }}!‚ú®MIN‚ú®!"
